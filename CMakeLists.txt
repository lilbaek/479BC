cmake_minimum_required(VERSION 2.6)
project(julius)

set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH}" "${CMAKE_SOURCE_DIR}/cmake/")

if (CMAKE_COMPILER_IS_GNUCC)
    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Werror=implicit-function-declaration")

    if (CMAKE_C_COMPILER_VERSION VERSION_GREATER 4.9.0)
        set(CMAKE_C_FLAGS "-Werror=incompatible-pointer-types -Werror=int-conversion ${CMAKE_C_FLAGS}")
    else ()
        set(CMAKE_C_STANDARD 99) # -std=gnu99
    endif()
endif()

set(SMK_FILES
    ext/libsmacker/smacker.c
    ext/libsmacker/smk_bitstream.c
    ext/libsmacker/smk_hufftree.c
)
set(CORE_FILES
    ${PROJECT_SOURCE_DIR}/src/core/buffer.c
    ${PROJECT_SOURCE_DIR}/src/core/calc.c
    ${PROJECT_SOURCE_DIR}/src/core/debug.c
    ${PROJECT_SOURCE_DIR}/src/core/dir.c
    ${PROJECT_SOURCE_DIR}/src/core/file.c
    ${PROJECT_SOURCE_DIR}/src/core/image.c
    ${PROJECT_SOURCE_DIR}/src/core/io.c
    ${PROJECT_SOURCE_DIR}/src/core/lang.c
    ${PROJECT_SOURCE_DIR}/src/core/random.c
    ${PROJECT_SOURCE_DIR}/src/core/string.c
    ${PROJECT_SOURCE_DIR}/src/core/time.c
    ${PROJECT_SOURCE_DIR}/src/core/zip.c
)

set(PLATFORM_FILES
    ${PROJECT_SOURCE_DIR}/platform/main2.c
    ${PROJECT_SOURCE_DIR}/platform/SDLSoundDevice.c
)

set(BUILDING_FILES
    ${PROJECT_SOURCE_DIR}/src/building/animation.c
    ${PROJECT_SOURCE_DIR}/src/building/barracks.c
    ${PROJECT_SOURCE_DIR}/src/building/building.c
    ${PROJECT_SOURCE_DIR}/src/building/construction.c
    ${PROJECT_SOURCE_DIR}/src/building/construction_building.c
    ${PROJECT_SOURCE_DIR}/src/building/construction_clear.c
    ${PROJECT_SOURCE_DIR}/src/building/construction_warning.c
    ${PROJECT_SOURCE_DIR}/src/building/count.c
    ${PROJECT_SOURCE_DIR}/src/building/destruction.c
    ${PROJECT_SOURCE_DIR}/src/building/dock.c
    ${PROJECT_SOURCE_DIR}/src/building/figure.c
    ${PROJECT_SOURCE_DIR}/src/building/government.c
    ${PROJECT_SOURCE_DIR}/src/building/granary.c
    ${PROJECT_SOURCE_DIR}/src/building/house.c
    ${PROJECT_SOURCE_DIR}/src/building/house_evolution.c
    ${PROJECT_SOURCE_DIR}/src/building/house_population.c
    ${PROJECT_SOURCE_DIR}/src/building/house_service.c
    ${PROJECT_SOURCE_DIR}/src/building/industry.c
    ${PROJECT_SOURCE_DIR}/src/building/list.c
    ${PROJECT_SOURCE_DIR}/src/building/maintenance.c
    ${PROJECT_SOURCE_DIR}/src/building/market.c
    ${PROJECT_SOURCE_DIR}/src/building/menu.c
    ${PROJECT_SOURCE_DIR}/src/building/model.c
    ${PROJECT_SOURCE_DIR}/src/building/properties.c
    ${PROJECT_SOURCE_DIR}/src/building/storage.c
    ${PROJECT_SOURCE_DIR}/src/building/warehouse.c
)
set(CITY_FILES
    ${PROJECT_SOURCE_DIR}/src/city/culture.c
    ${PROJECT_SOURCE_DIR}/src/city/data.c
    ${PROJECT_SOURCE_DIR}/src/city/emperor.c
    ${PROJECT_SOURCE_DIR}/src/city/finance.c
    ${PROJECT_SOURCE_DIR}/src/city/gods.c
    ${PROJECT_SOURCE_DIR}/src/city/health.c
    ${PROJECT_SOURCE_DIR}/src/city/labor.c
    ${PROJECT_SOURCE_DIR}/src/city/message.c
    ${PROJECT_SOURCE_DIR}/src/city/population.c
    ${PROJECT_SOURCE_DIR}/src/city/ratings.c
    ${PROJECT_SOURCE_DIR}/src/city/resource.c
    ${PROJECT_SOURCE_DIR}/src/city/sentiment.c
    ${PROJECT_SOURCE_DIR}/src/city/trade.c
    ${PROJECT_SOURCE_DIR}/src/city/victory.c
    ${PROJECT_SOURCE_DIR}/src/city/view.c
    ${PROJECT_SOURCE_DIR}/src/city/warning.c
)
set(EMPIRE_FILES
    ${PROJECT_SOURCE_DIR}/src/empire/city.c
    ${PROJECT_SOURCE_DIR}/src/empire/empire.c
    ${PROJECT_SOURCE_DIR}/src/empire/object.c
    ${PROJECT_SOURCE_DIR}/src/empire/trade_prices.c
    ${PROJECT_SOURCE_DIR}/src/empire/trade_route.c
)
set(FIGURE_FILES
    ${PROJECT_SOURCE_DIR}/src/figure/action.c
    ${PROJECT_SOURCE_DIR}/src/figure/combat.c
    ${PROJECT_SOURCE_DIR}/src/figure/enemy_army.c
    ${PROJECT_SOURCE_DIR}/src/figure/figure.c
    ${PROJECT_SOURCE_DIR}/src/figure/formation.c
    ${PROJECT_SOURCE_DIR}/src/figure/formation_enemy.c
    ${PROJECT_SOURCE_DIR}/src/figure/formation_herd.c
    ${PROJECT_SOURCE_DIR}/src/figure/formation_layout.c
    ${PROJECT_SOURCE_DIR}/src/figure/formation_legion.c
    ${PROJECT_SOURCE_DIR}/src/figure/image.c
    ${PROJECT_SOURCE_DIR}/src/figure/movement.c
    ${PROJECT_SOURCE_DIR}/src/figure/name.c
    ${PROJECT_SOURCE_DIR}/src/figure/phrase.c
    ${PROJECT_SOURCE_DIR}/src/figure/properties.c
    ${PROJECT_SOURCE_DIR}/src/figure/route.c
    ${PROJECT_SOURCE_DIR}/src/figure/service.c
    ${PROJECT_SOURCE_DIR}/src/figure/sound.c
    ${PROJECT_SOURCE_DIR}/src/figure/trader.c
)
set(FIGURETYPE_FILES
    ${PROJECT_SOURCE_DIR}/src/figuretype/animal.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/cartpusher.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/crime.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/docker.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/enemy.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/entertainer.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/maintenance.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/market.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/migrant.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/missile.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/native.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/service.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/soldier.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/trader.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/wall.c
    ${PROJECT_SOURCE_DIR}/src/figuretype/water.c
)
set(GAME_FILES
    ${PROJECT_SOURCE_DIR}/src/game/animation.c
    ${PROJECT_SOURCE_DIR}/src/game/difficulty.c
    ${PROJECT_SOURCE_DIR}/src/game/file.c
    ${PROJECT_SOURCE_DIR}/src/game/file_io.c
    ${PROJECT_SOURCE_DIR}/src/game/game.c
    ${PROJECT_SOURCE_DIR}/src/game/mission.c
    ${PROJECT_SOURCE_DIR}/src/game/resource.c
    ${PROJECT_SOURCE_DIR}/src/game/settings.c
    ${PROJECT_SOURCE_DIR}/src/game/state.c
    ${PROJECT_SOURCE_DIR}/src/game/tick.c
    ${PROJECT_SOURCE_DIR}/src/game/time.c
    ${PROJECT_SOURCE_DIR}/src/game/tutorial.c
    ${PROJECT_SOURCE_DIR}/src/game/undo.c
)
set(INPUT_FILES
    ${PROJECT_SOURCE_DIR}/src/input/cursor.c
    ${PROJECT_SOURCE_DIR}/src/input/hotkey.c
    ${PROJECT_SOURCE_DIR}/src/input/keyboard.c
    ${PROJECT_SOURCE_DIR}/src/input/mouse.c
    ${PROJECT_SOURCE_DIR}/src/input/scroll.c
)
set(MAP_FILES
    ${PROJECT_SOURCE_DIR}/src/map/aqueduct.c
    ${PROJECT_SOURCE_DIR}/src/map/bookmark.c
    ${PROJECT_SOURCE_DIR}/src/map/bridge.c
    ${PROJECT_SOURCE_DIR}/src/map/building.c
    ${PROJECT_SOURCE_DIR}/src/map/building_tiles.c
    ${PROJECT_SOURCE_DIR}/src/map/desirability.c
    ${PROJECT_SOURCE_DIR}/src/map/elevation.c
    ${PROJECT_SOURCE_DIR}/src/map/figure.c
    ${PROJECT_SOURCE_DIR}/src/map/grid.c
    ${PROJECT_SOURCE_DIR}/src/map/image.c
    ${PROJECT_SOURCE_DIR}/src/map/image_context.c
    ${PROJECT_SOURCE_DIR}/src/map/natives.c
    ${PROJECT_SOURCE_DIR}/src/map/orientation.c
    ${PROJECT_SOURCE_DIR}/src/map/property.c
    ${PROJECT_SOURCE_DIR}/src/map/random.c
    ${PROJECT_SOURCE_DIR}/src/map/ring.c
    ${PROJECT_SOURCE_DIR}/src/map/road_access.c
    ${PROJECT_SOURCE_DIR}/src/map/road_aqueduct.c
    ${PROJECT_SOURCE_DIR}/src/map/road_network.c
    ${PROJECT_SOURCE_DIR}/src/map/routing.c
    ${PROJECT_SOURCE_DIR}/src/map/routing_data.c
    ${PROJECT_SOURCE_DIR}/src/map/routing_path.c
    ${PROJECT_SOURCE_DIR}/src/map/routing_terrain.c
    ${PROJECT_SOURCE_DIR}/src/map/soldier_strength.c
    ${PROJECT_SOURCE_DIR}/src/map/sprite.c
    ${PROJECT_SOURCE_DIR}/src/map/terrain.c
    ${PROJECT_SOURCE_DIR}/src/map/tiles.c
    ${PROJECT_SOURCE_DIR}/src/map/water.c
    ${PROJECT_SOURCE_DIR}/src/map/water_supply.c
)
set(SCENARIO_FILES
    ${PROJECT_SOURCE_DIR}/src/scenario/building.c
    ${PROJECT_SOURCE_DIR}/src/scenario/criteria.c
    ${PROJECT_SOURCE_DIR}/src/scenario/demand_change.c
    ${PROJECT_SOURCE_DIR}/src/scenario/distant_battle.c
    ${PROJECT_SOURCE_DIR}/src/scenario/earthquake.c
    ${PROJECT_SOURCE_DIR}/src/scenario/emperor_change.c
    ${PROJECT_SOURCE_DIR}/src/scenario/empire.c
    ${PROJECT_SOURCE_DIR}/src/scenario/gladiator_revolt.c
    ${PROJECT_SOURCE_DIR}/src/scenario/invasion.c
    ${PROJECT_SOURCE_DIR}/src/scenario/map.c
    ${PROJECT_SOURCE_DIR}/src/scenario/price_change.c
    ${PROJECT_SOURCE_DIR}/src/scenario/property.c
    ${PROJECT_SOURCE_DIR}/src/scenario/random_event.c
    ${PROJECT_SOURCE_DIR}/src/scenario/request.c
    ${PROJECT_SOURCE_DIR}/src/scenario/scenario.c
)
set(GRAPHICS_FILES
    ${PROJECT_SOURCE_DIR}/src/graphics/arrow_button.c
    ${PROJECT_SOURCE_DIR}/src/graphics/button.c
    ${PROJECT_SOURCE_DIR}/src/graphics/font.c
    ${PROJECT_SOURCE_DIR}/src/graphics/generic_button.c
    ${PROJECT_SOURCE_DIR}/src/graphics/graphics.c
    ${PROJECT_SOURCE_DIR}/src/graphics/image.c
    ${PROJECT_SOURCE_DIR}/src/graphics/image_button.c
    ${PROJECT_SOURCE_DIR}/src/graphics/lang_text.c
    ${PROJECT_SOURCE_DIR}/src/graphics/menu.c
    ${PROJECT_SOURCE_DIR}/src/graphics/panel.c
    ${PROJECT_SOURCE_DIR}/src/graphics/rich_text.c
    ${PROJECT_SOURCE_DIR}/src/graphics/screen.c
    ${PROJECT_SOURCE_DIR}/src/graphics/text.c
    ${PROJECT_SOURCE_DIR}/src/graphics/video.c
    ${PROJECT_SOURCE_DIR}/src/graphics/window.c
)
set(SOUND_FILES
    ${PROJECT_SOURCE_DIR}/src/sound/city.c
    ${PROJECT_SOURCE_DIR}/src/sound/effect.c
    ${PROJECT_SOURCE_DIR}/src/sound/music.c
    ${PROJECT_SOURCE_DIR}/src/sound/speech.c
    ${PROJECT_SOURCE_DIR}/src/sound/system.c
)
add_executable(julius
	${PLATFORM_FILES}
	${PROJECT_SOURCE_DIR}/src/Data/Model.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Chief.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Education.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Entertainment.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Financial.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Health.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Imperial.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Labor.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Military.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Population.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Ratings.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Religion.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisor_Trade.c
	${PROJECT_SOURCE_DIR}/src/UI/Advisors.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Culture.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Decoration.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Distribution.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Engineering.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Entertainment.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Figures.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Government.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_House.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Industry.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Military.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Native.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Terrain.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingInfo_Water.c
	${PROJECT_SOURCE_DIR}/src/UI/BuildingMenu.c
	${PROJECT_SOURCE_DIR}/src/UI/CCKSelection.c
	${PROJECT_SOURCE_DIR}/src/UI/City.c
	${PROJECT_SOURCE_DIR}/src/UI/CityBuildings.c
	${PROJECT_SOURCE_DIR}/src/UI/CityBuildings_Figures.c
	${PROJECT_SOURCE_DIR}/src/UI/CityBuildings_Ghost.c
	${PROJECT_SOURCE_DIR}/src/UI/CityBuildings_Overlay.c
	${PROJECT_SOURCE_DIR}/src/UI/CityBuildings_Scroll.c
	${PROJECT_SOURCE_DIR}/src/UI/DifficultyOptions.c
	${PROJECT_SOURCE_DIR}/src/UI/DisplayOptions.c
	${PROJECT_SOURCE_DIR}/src/UI/DonateToCityDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/EmpireMap.c
	${PROJECT_SOURCE_DIR}/src/UI/FileDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/HoldFestivalDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/Intermezzo.c
	${PROJECT_SOURCE_DIR}/src/UI/Logo.c
	${PROJECT_SOURCE_DIR}/src/UI/MainMenu.c
	${PROJECT_SOURCE_DIR}/src/UI/MessageDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/Minimap.c
	${PROJECT_SOURCE_DIR}/src/UI/MissionEnd.c
	${PROJECT_SOURCE_DIR}/src/UI/MissionStart.c
	${PROJECT_SOURCE_DIR}/src/UI/NewCareerDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/OverlayMenu.c
	${PROJECT_SOURCE_DIR}/src/UI/PlayerMessageList.c
	${PROJECT_SOURCE_DIR}/src/UI/PopupDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/SendGiftToCaesarDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/SetSalaryDialog.c
	${PROJECT_SOURCE_DIR}/src/UI/Sidebar.c
	${PROJECT_SOURCE_DIR}/src/UI/SoundOptions.c
	${PROJECT_SOURCE_DIR}/src/UI/SpeedOptions.c
	${PROJECT_SOURCE_DIR}/src/UI/Tooltip.c
	${PROJECT_SOURCE_DIR}/src/UI/TopMenu.c
	${PROJECT_SOURCE_DIR}/src/UI/VideoIntermezzo.c
	${PROJECT_SOURCE_DIR}/src/UI/Warning.c
	${CORE_FILES}
	${BUILDING_FILES}
	${CITY_FILES}
	${EMPIRE_FILES}
	${FIGURE_FILES}
	${FIGURETYPE_FILES}
	${GAME_FILES}
	${INPUT_FILES}
	${MAP_FILES}
	${SCENARIO_FILES}
	${GRAPHICS_FILES}
	${SOUND_FILES}
	${SMK_FILES}
)

find_package(SDL2 REQUIRED)
find_package(SDL2_mixer REQUIRED)

include_directories(${SDL2_INCLUDE_DIR})
include_directories(${SDL2_MIXER_INCLUDE_DIR})

include_directories(ext)
include_directories(src)

target_link_libraries (julius ${SDL2_LIBRARY} ${SDL2_MIXER_LIBRARY})

install(TARGETS julius RUNTIME DESTINATION bin)

# Unit tests
enable_testing()
add_subdirectory(test)

